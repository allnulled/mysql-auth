<%
if(args.length === 0) {
	throw new Error("Argument 1 is required to <login>");
}
if(typeof args[0] !== "object") {
	throw new Error("Argument 1 must be an object to <login>");
}

const [userData={}, sessionData={}] = args;

%>

INSERT INTO $auth$session (
	id_user,
	token,
	secret_token
) VALUES (
	<%-SQL.escape(userData.id)%>,
	<%-SQL.escape(sessionData.token)%>,
	<%-SQL.escape(sessionData.secret_token)%>
);